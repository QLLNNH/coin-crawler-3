<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>My Coin</title>
    <style type="text/css">
        #outer {
            width: 500px;
            height: 100%;
            margin: 0 auto;
        }

        #symbols {
            font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
            width: 100%;
            border-collapse: collapse;
        }

        #symbols td, #symbols th {
            font-size: 1em;
            border: 1px solid #98bf21;
            padding: 5px 0px 4px 5px;
        }

        #symbols th {
            width: 20%;
            font-size: 1.1em;
            text-align: left;
            background-color: #A7C942;
            color: #ffffff;
            text-align: center;
        }

        #symbols td {
            font-size: 1em;
            text-align: center;
        }

        select {
            width: 90%;
            margin: 0px auto;
            display: block;
            padding: 5px -1px 5px 0px;
        }

    </style>
</head>
<body>
<div id="outer">
    <table id="symbols">
        <tr id="platform">
            <th id="interval">
                <select id="select">
                    <option selected="selected" value="5">5min</option>
                    <option value="10">10min</option>
                    <option value="15">15min</option>
                    <option value="30">30min</option>
                </select>
            </th>
            <th id="">QC</th>
            <th id="">BTC</th>
            <th id="">USDT</th>
            <th id="">总额</th>
        </tr>
    </table>
</div>
</body>
</html>
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
<script src="/socket.io/socket.io.js"></script>
<script>
    $(document).ready(() => {
        let interval = 5;

        const socket = io();

        socket.emit('kline', interval);

        socket.on('change', () => socket.emit('kline', interval));

        socket.on('kline', (rows) => {
            if (Array.isArray(rows) && rows.length) {
                $('#symbols .symbol').remove();
                rows.forEach((row) => {
                    $('#symbols').append(`<tr class="symbol"><td>${row[0]}</td><td>${row[1]}</td><td>${row[2]}</td><td>${row[3]}</td><td>${row[4]}</td></tr>`)
                });
            }
            else {
                alert('服务器刚启动，加载完毕后页面会刷新');
            }
        });

        $("#select").change(function () {
            interval = parseInt($(this).val());
            socket.emit('kline', interval);
        });
    });
</script>